{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—Ä–æ—Ñ–∏–ª—å ‚Äî Nice luk</title>
    <link rel="stylesheet" href="{% static 'style.css' %}">
</head>
<body>
<div class="container">
    <header class="header">
        <div class="nav">
            <h1 class="logo">Nice luk</h1>
            <ul class="menu">
                <li><a href="/">üè† –ì–ª–∞–≤–Ω–∞—è</a></li>
                <li><a href="/cart/">üõí –ö–æ—Ä–∑–∏–Ω–∞</a></li>
                <li><a href="/about/">üè¢ –û –∫–æ–º–ø–∞–Ω–∏–∏</a></li>
                <li><a href="/profile/">üë§ –ü—Ä–æ—Ñ–∏–ª—å</a></li>
                <li style="display: flex; align-items: center;">
                    <form method="post" action="{% url 'logout' %}" style="display: inline;">
                        {% csrf_token %}
                        <button type="submit" style="
                            background: none;
                            border: none;
                            font-family: 'Segoe UI', sans-serif;
                            font-size: 16px;
                            font-weight: 500;
                            color: #333;
                            cursor: pointer;
                            padding: 0;
                            margin: 0;
                        ">
                            üö™ –í—ã–π—Ç–∏
                        </button>
                    </form>
                </li>
            </ul>
        </div>
    </header>

    <h2 class="title">üë§ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</h2>

    <h3>üìÑ –õ–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h3>
    <form method="post" style="max-width: 400px; margin-bottom: 30px;">
        {% csrf_token %}
        {{ user_form.as_p }}
        <button type="submit" class="button">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    </form>

    <hr>

    {% if orders %}
        <h3>üßæ –ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤</h3>
        <ul style="padding-left: 20px;">
            {% for order in orders %}
                <li style="margin-bottom: 20px; border-bottom: 1px solid #ddd; padding-bottom: 10px;">
                    <strong>üìÖ –î–∞—Ç–∞:</strong> {{ order.created_at|date:"d.m.Y H:i" }}<br>
                    <strong>üõç –¢–æ–≤–∞—Ä—ã:</strong>
                    <ul>
                        {% for item in order.items.all %}
                            <li>{{ item.product.name }} ‚Äî {{ item.quantity }} —à—Ç.</li>
                        {% endfor %}
                    </ul>
                    <strong>üí∞ –°—É–º–º–∞:</strong> {{ order.total_price }} ‚ÇΩ<br>
                    {% if order.delivery_method == 'pickup' %}
                        <strong>üè™ –ü—É–Ω–∫—Ç —Å–∞–º–æ–≤—ã–≤–æ–∑–∞:</strong> –≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ì–µ–Ω–µ—Ä–∞–ª–∞ –ë–µ–ª–æ–±–æ—Ä–æ–¥–æ–≤–∞, –¥. 21, –∫–æ—Ä–ø. 3<br>
                    {% else %}
                        <strong>üìç –ê–¥—Ä–µ—Å:</strong> {{ order.address }}<br>
                    {% endif %}
                    <strong>üìû –¢–µ–ª–µ—Ñ–æ–Ω:</strong> {{ order.phone }}<br>
                    <strong>üöö –î–æ—Å—Ç–∞–≤–∫–∞:</strong> {{ order.get_delivery_method_display }}
                </li>
            {% endfor %}
        </ul>

        <form action="{% url 'clear_order_history' %}" method="post" onsubmit="return confirm('–£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∑–∞–∫–∞–∑—ã?');">
            {% csrf_token %}
            <button type="submit" class="btn danger">üóë –û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∑–∞–∫–∞–∑–æ–≤</button>
        </form>
    {% else %}
        <p>‚ùå –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–∫–∞–∑–æ–≤.</p>
    {% endif %}

    <a href="/" class="button" style="margin-top: 30px;">‚¨Ö –ù–∞ –≥–ª–∞–≤–Ω—É—é</a>

    {% include 'asort/footer.html' %}
</div>
</body>
</html>