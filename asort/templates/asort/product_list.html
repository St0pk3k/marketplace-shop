{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>–¢–æ–≤–∞—Ä—ã ‚Äî Nice luk</title>
    <link rel="stylesheet" href="{% static 'style.css' %}" />
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="nav">
                <h1 class="logo">Nice luk</h1>
                <ul class="menu">
                    <li><a href="/">üè† –ì–ª–∞–≤–Ω–∞—è</a></li>
                    <li><a href="/cart/">üõí –ö–æ—Ä–∑–∏–Ω–∞</a></li>
                    <li><a href="/about/">üè¢ –û –∫–æ–º–ø–∞–Ω–∏–∏</a></li>
                    {% if user.is_authenticated %}
                        <li><a href="/profile/">üë§ –ü—Ä–æ—Ñ–∏–ª—å</a></li>
                        <li style="display: flex; align-items: center;">
                            <form method="post" action="{% url 'logout' %}" style="display: inline;">
                                {% csrf_token %}
                                <button type="submit" style="
                                    background: none;
                                    border: none;
                                    font-family: 'Segoe UI', sans-serif;
                                    font-size: 16px;
                                    font-weight: 500;
                                    color: #333;
                                    cursor: pointer;
                                    padding: 0;
                                    margin: 0;
                                ">
                                    üö™ –í—ã–π—Ç–∏
                                </button>
                            </form>
                        </li>
                    {% else %}
                        <li><a href="/accounts/login/">üîê –í–æ–π—Ç–∏</a></li>
                        <li><a href="/register/">üìù –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a></li>
                    {% endif %}
                </ul>
            </div>
        </header>

        <h2 class="title">–í—Å–µ —Ç–æ–≤–∞—Ä—ã</h2>

        <!-- –ü–æ–∏—Å–∫ -->
        <form method="get" action="" class="search-form">
            <input type="text" name="q" placeholder="–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤..." value="{{ request.GET.q }}">
            <button type="submit">üîç –ù–∞–π—Ç–∏</button>
        </form>

        <!-- –§–∏–ª—å—Ç—Ä -->
        <form method="get" action="" class="filter-form">
            <label for="category">–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</label>
            <select name="category" id="category">
                <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                {% for cat in categories %}
                    <option value="{{ cat.id }}" {% if request.GET.category == cat.id|stringformat:"s" %}selected{% endif %}>
                        {{ cat.name }}
                    </option>
                {% endfor %}
            </select>

            <label for="size">–†–∞–∑–º–µ—Ä:</label>
            <select name="size" id="size">
                <option value="all" {% if selected_size == 'all' or not selected_size %}selected{% endif %}>–í—Å–µ —Ä–∞–∑–º–µ—Ä—ã</option>
                {% for s in sizes %}
                    <option value="{{ s }}" {% if selected_size == s %}selected{% endif %}>{{ s }}</option>
                {% endfor %}
            </select>

            <label for="min_price">–¶–µ–Ω–∞ –æ—Ç:</label>
            <input type="number" name="min_price" id="min_price" value="{{ request.GET.min_price }}">

            <label for="max_price">–¥–æ:</label>
            <input type="number" name="max_price" id="max_price" value="{{ request.GET.max_price }}">
            <span>‚ÇΩ</span>

            <button type="submit">‚úÖ –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä</button>
        </form>

        <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤ -->
        <ul class="product-list">
            {% for product in products %}
                <li class="product-card">
                    <a href="{% url 'product_detail' product.id %}" class="product-link">
                        {% if product.image %}
                            <img src="{{ product.image.url }}" alt="{{ product.name }}">
                        {% endif %}
                        <h3>{{ product.name }}</h3>
                    </a>
                    <p>{{ product.description }}</p>
                    <p>–†–∞–∑–º–µ—Ä: {{ product.size|default:"‚Äî" }}</p>
                    <p><strong>{{ product.price }} ‚ÇΩ</strong></p>
                    <a href="{% url 'add_to_cart' product.id %}" class="button">‚ûï –í –∫–æ—Ä–∑–∏–Ω—É</a>
                </li>
            {% empty %}
                <li>–¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.</li>
            {% endfor %}
        </ul>

        <div class="go-to-cart">
            <a href="/cart/" class="button">üõí –ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–æ—Ä–∑–∏–Ω—É</a>
        </div>

        {% include 'asort/footer.html' %}
    </div>
</body>
</html>